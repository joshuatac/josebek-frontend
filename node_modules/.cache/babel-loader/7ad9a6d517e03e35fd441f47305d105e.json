{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\development\\\\Desktop\\\\josebek store\\\\frontend-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _objectSpread from \"C:\\\\Users\\\\development\\\\Desktop\\\\josebek store\\\\frontend-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\development\\\\Desktop\\\\josebek store\\\\frontend-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport axios from '../helpers/axios';\nimport { authConstants, cartConstants } from './constant';\nexport var login = function login(user) {\n  console.log(user);\n  return /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch) {\n      var res, _res$data, token, _user;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              dispatch({\n                type: authConstants.LOGIN_REQUEST\n              });\n              _context.next = 3;\n              return axios.post(\"/login\", _objectSpread({}, user));\n\n            case 3:\n              res = _context.sent;\n\n              if (res.status === 200) {\n                _res$data = res.data, token = _res$data.token, _user = _res$data.user;\n                localStorage.setItem('token', token);\n                localStorage.setItem('user', JSON.stringify(_user));\n                dispatch({\n                  type: authConstants.LOGIN_SUCCESS,\n                  payload: {\n                    token: token,\n                    user: _user\n                  }\n                });\n              } else {\n                if (res.status === 400) {\n                  dispatch({\n                    type: authConstants.LOGIN_FAILURE,\n                    payload: {\n                      error: res.data.error\n                    }\n                  });\n                }\n              }\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n};\nexport var isUserLoggedIn = function isUserLoggedIn() {\n  return /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch) {\n      var token, _user2;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              token = localStorage.getItem('token');\n\n              if (token) {\n                _user2 = JSON.parse(localStorage.getItem('user'));\n                dispatch({\n                  type: authConstants.LOGIN_SUCCESS,\n                  payload: {\n                    token: token,\n                    user: _user2\n                  }\n                });\n              } else {\n                dispatch({\n                  type: authConstants.LOGIN_FAILURE,\n                  payload: {\n                    error: 'Failed to login'\n                  }\n                });\n              }\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function (_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n};\nexport var register = function register() {\n  return /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch) {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              dispatch({\n                type: authConstants.SIGNUP_REQUEST\n              });\n              _context3.next = 4;\n              return axios.post('/register', user);\n\n            case 4:\n              res = _context3.sent;\n              _context3.next = 10;\n              break;\n\n            case 7:\n              _context3.prev = 7;\n              _context3.t0 = _context3[\"catch\"](0);\n              console.log(_context3.t0);\n\n            case 10:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[0, 7]]);\n    }));\n\n    return function (_x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n};\nexport var signout = function signout() {\n  return /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch) {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              dispatch({\n                type: authConstants.LOGOUT_REQUEST\n              }); // localStorage.removeItem('user');\n              // localStorage.removeItem('token')\n\n              localStorage.clear();\n              dispatch({\n                type: authConstants.LOGOUT_SUCCESS\n              });\n              dispatch({\n                type: cartConstants.RESET_CART\n              }); // \tdispatch({ type: authConstants.LOGOUT_REQUEST });\n              // \tconst res = await axios.post('/admin/logout');\n              // \tif (res.status === 200) {\n              // \t\tlocalStorage.clear();\n              // \t\tdispatch({\n              // \t\t\ttype: authConstants.LOGOUT_SUCCESS,\n              // \t\t});\n              // \t} else {\n              // \t\tdispatch({\n              // \t\t\ttype: authConstants.LOGOUT_FAILURE,\n              // \t\t\tpayload: { error: res.data.error },\n              // \t\t});\n              // \t}\n\n            case 4:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function (_x4) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n};","map":{"version":3,"sources":["C:/Users/development/Desktop/josebek store/frontend-app/src/actions/auth.aution.js"],"names":["axios","authConstants","cartConstants","login","user","console","log","dispatch","type","LOGIN_REQUEST","post","res","status","data","token","localStorage","setItem","JSON","stringify","LOGIN_SUCCESS","payload","LOGIN_FAILURE","error","isUserLoggedIn","getItem","parse","register","SIGNUP_REQUEST","signout","LOGOUT_REQUEST","clear","LOGOUT_SUCCESS","RESET_CART"],"mappings":"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","sourcesContent":["import axios from '../helpers/axios';\r\nimport { authConstants, cartConstants } from './constant';\r\n\r\nexport const login = (user) => {\r\n\tconsole.log(user);\r\n\treturn async (dispatch) => {\r\n\t\tdispatch({ type: authConstants.LOGIN_REQUEST });\r\n\t\tconst res = await axios.post(`/login`, {\r\n\t\t\t...user,\r\n\t\t});\r\n\r\n\t\tif (res.status === 200) {\r\n\t\t\tconst { token, user } = res.data;\r\n\t\t\tlocalStorage.setItem('token', token);\r\n\t\t\tlocalStorage.setItem('user', JSON.stringify(user));\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: authConstants.LOGIN_SUCCESS,\r\n\t\t\t\tpayload: {\r\n\t\t\t\t\ttoken,\r\n\t\t\t\t\tuser,\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tif (res.status === 400) {\r\n\t\t\t\tdispatch({\r\n\t\t\t\t\ttype: authConstants.LOGIN_FAILURE,\r\n\t\t\t\t\tpayload: { error: res.data.error },\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n};\r\n\r\nexport const isUserLoggedIn = () => {\r\n\treturn async (dispatch) => {\r\n\t\tconst token = localStorage.getItem('token');\r\n\t\tif (token) {\r\n\t\t\tconst user = JSON.parse(localStorage.getItem('user'));\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: authConstants.LOGIN_SUCCESS,\r\n\t\t\t\tpayload: {\r\n\t\t\t\t\ttoken,\r\n\t\t\t\t\tuser,\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: authConstants.LOGIN_FAILURE,\r\n\t\t\t\tpayload: { error: 'Failed to login' },\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n};\r\n\r\nexport const register = () => {\r\n\treturn async (dispatch) => {\r\n\t\ttry{\r\ndispatch({ type: authConstants.SIGNUP_REQUEST});\r\nconst res = await axios.post('/register', user)\r\n\t\t} catch (error){\r\n\t\t\tconsole.log(error)\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport const signout = () => {\r\n\treturn async (dispatch) => {\r\n\r\n\t\tdispatch({\r\n\t\t\ttype: authConstants.LOGOUT_REQUEST\r\n\t\t});\r\n\t\t\r\n\t\t// localStorage.removeItem('user');\r\n\t\t// localStorage.removeItem('token')\r\n\t\tlocalStorage.clear();\r\n\t\tdispatch({ type: authConstants.LOGOUT_SUCCESS});\r\n\t\tdispatch({ type: cartConstants.RESET_CART});\r\n\t// \tdispatch({ type: authConstants.LOGOUT_REQUEST });\r\n\t// \tconst res = await axios.post('/admin/logout');\r\n\r\n\t// \tif (res.status === 200) {\r\n\t// \t\tlocalStorage.clear();\r\n\t// \t\tdispatch({\r\n\t// \t\t\ttype: authConstants.LOGOUT_SUCCESS,\r\n\t// \t\t});\r\n\t// \t} else {\r\n\t// \t\tdispatch({\r\n\t// \t\t\ttype: authConstants.LOGOUT_FAILURE,\r\n\t// \t\t\tpayload: { error: res.data.error },\r\n\t// \t\t});\r\n\t// \t}\r\n\t};\r\n};\r\n\r\n\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}